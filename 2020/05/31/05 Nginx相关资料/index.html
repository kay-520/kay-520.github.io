<!DOCTYPE html>
<html lang="zh-CN">





<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#000">
  <meta name="description" content="æ¸…é†’ è¯†è¶£ åŠªåŠ› ä¼˜ç§€ ä¸è´Ÿä½™ç”ŸğŸƒ">
  <meta name="author" content="karma">
  <meta name="keywords" content="">
  <title>Nginxç›¸å…³èµ„æ–™ - Karma ã® å°å±‹</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/github-gist.min.css" />
  

  


<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_yg9cfy8wd6.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_pjno9b9zyxs.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- è‡ªå®šä¹‰æ ·å¼ä¿æŒåœ¨æœ€åº•éƒ¨ -->


<meta name="generator" content="Hexo 4.2.1"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Karma ã® Blog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                å‹é“¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0)">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              
  <div class="mt-3 post-meta">
    <i class="iconfont icon-date-fill" aria-hidden="true"></i>
    <time datetime="2020-05-31 10:04">
      2020å¹´5æœˆ31æ—¥ ä¸Šåˆ
    </time>
  </div>


<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      5.1k å­—
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      63
       åˆ†é’Ÿ
    </span>
  

  
  
    
      <!-- LeanCloud ç»Ÿè®¡æ–‡ç« PV -->
      <span id="leancloud-post-views-container" class="post-meta" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="leancloud-post-views"></span> æ¬¡
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <div class="post-content mx-auto" id="post">
            
            <article class="markdown-body">
              <h4 id="ä¸€ã€å®‰è£…"><a href="#ä¸€ã€å®‰è£…" class="headerlink" title="ä¸€ã€å®‰è£…"></a>ä¸€ã€å®‰è£…</h4><p>1.å®‰è£…ç¼–è¯‘å·¥å…·åŠåº“æ–‡ä»¶</p>
<pre><code class="hljs shell">yum -y install make zlib zlib-devel gcc-c++ libtool  openssl openssl-devel</code></pre>

<p>2.è§£å‹</p>
<pre><code class="hljs shell">tar -zxvf nginx.nginx-1.16.1.tar.gz</code></pre>

<p>3.ç¼–è¯‘ï¼Œå¹¶æŒ‡å®šç›®å½•</p>
<pre><code class="hljs shell">./configure --prefix=/usr/local/nginx
make &amp;&amp; make install</code></pre>

<p>4.å¯åŠ¨</p>
<pre><code class="hljs shell">cd /usr/local/nginx/sbin
<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># å¯åŠ¨</span></span>
./nginx
<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># åœæ­¢</span></span>
./nginx -s stop</code></pre>

<h4 id="äºŒã€åå‘ä»£ç†"><a href="#äºŒã€åå‘ä»£ç†" class="headerlink" title="äºŒã€åå‘ä»£ç†"></a>äºŒã€åå‘ä»£ç†</h4><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># ä¿®æ”¹é…ç½®æ–‡ä»¶nginx.conf</span></span>
server &#123;
        listen       80;
        server_name  localhost;
<span class="hljs-meta">		#</span><span class="bash"> </span>
        location / &#123;
            proxy_pass   http://127.0.0.1:8080;
            index  index.html index.htm;
        &#125;
    &#125;</code></pre>

<h4 id="ä¸‰ã€è´Ÿè½½å‡è¡¡"><a href="#ä¸‰ã€è´Ÿè½½å‡è¡¡" class="headerlink" title="ä¸‰ã€è´Ÿè½½å‡è¡¡"></a>ä¸‰ã€è´Ÿè½½å‡è¡¡</h4><blockquote>
<p>äº”ç§è´Ÿè½½å‡è¡¡ç­–ç•¥</p>
<p>1.è½®è®­ï¼ˆdefaultï¼‰ï¼šæ ¹æ®æ—¶é—´é¡ºåºåˆ†é…ä¸åŒæœåŠ¡å™¨</p>
<p>2.æƒé‡ï¼šæŒ‡å®šè½®è®­æœºç‡ï¼Œweightå’Œè®¿é—®æ¯”ç‡æˆæ­£æ¯”  </p>
<p>3.Ipç»‘å®šï¼šå›ºå®šipè®¿é—®</p>
<p>4.fairï¼šç¬¬ä¸‰æ–¹ï¼Œæ ¹æ®æœåŠ¡å“åº”æ—¶é—´åˆ†é…</p>
<p>5.url_hashï¼šç¬¬ä¸‰æ–¹ï¼ŒæŒ‰è®¿é—®urlçš„hashç»“æœæ¥åˆ†é…è¯·æ±‚ ï¼Œä½¿æ¯ä¸ªurlå®šå‘åˆ°åŒä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œåç«¯æœåŠ¡å™¨ä¸ºç¼“å­˜æ—¶æ¯”è¾ƒæœ‰æ•ˆ  </p>
<p>Nginxè´Ÿè½½å‡è¡¡æä¾›ä¸Šæ¸¸æœåŠ¡å™¨(çœŸå®ä¸šåŠ¡é€»è¾‘è®¿é—®çš„æœåŠ¡å™¨),è´Ÿè½½å‡è¡¡ã€æ•…éšœè½¬ç§»ã€å¤±è´¥é‡è¯•ã€å®¹é”™ã€å¥åº·æ£€æŸ¥ç­‰ã€‚</p>
<p>å½“ä¸Šæ¸¸æœåŠ¡å™¨(çœŸå®ä¸šåŠ¡é€»è¾‘è®¿é—®çš„æœåŠ¡å™¨)å‘ç”Ÿæ•…éšœæ—¶ï¼Œå¯ä»¥è½¬ç§»åˆ°å…¶ä»–ä¸Šæ¸¸æœåŠ¡å™¨(çœŸå®ä¸šåŠ¡é€»è¾‘è®¿é—®çš„æœåŠ¡å™¨)ã€‚</p>
</blockquote>
<p>1.upstream serveré…ç½®</p>
<p>1.1 è½®è®­</p>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">##å®šä¹‰ä¸Šæ¸¸æœåŠ¡å™¨(éœ€è¦è¢«nginxçœŸå®ä»£ç†è®¿é—®çš„æœåŠ¡å™¨) é»˜è®¤æ˜¯è½®è®­æœºåˆ¶</span></span>
upstream  backServer&#123;
	server 127.0.0.1:8080;
	server 127.0.0.1:8081;
&#125;

server &#123;
	listen       80;
	server_name  localhost;
	location / &#123;
<span class="hljs-meta">		#</span><span class="bash"><span class="hljs-comment">## æŒ‡å®šä¸Šæ¸¸æœåŠ¡å™¨è´Ÿè½½å‡è¡¡æœåŠ¡å™¨</span></span>
		proxy_pass http://backServer;
		index  index.html index.htm;
	&#125;
&#125;</code></pre>

<p>1.2 æƒé‡</p>
<pre><code class="hljs shell"> upstream  backServer&#123;
    server 127.0.0.1:8080 weight=1;
    server 127.0.0.1:8081 weight=2;
&#125;
	
server &#123;
       listen       80;
       server_name  localhost;
       location / &#123;
	    ### æŒ‡å®šä¸Šæ¸¸æœåŠ¡å™¨è´Ÿè½½å‡è¡¡æœåŠ¡å™¨
	    proxy_pass http://backServer;
           index  index.html index.htm;
       &#125;
   &#125;</code></pre>



<h4 id="nginx-confè¯¦è§£"><a href="#nginx-confè¯¦è§£" class="headerlink" title="nginx.confè¯¦è§£"></a>nginx.confè¯¦è§£</h4><pre><code class="hljs clean">##ä»£ç å—ä¸­çš„eventsã€httpã€serverã€locationã€upstreamç­‰éƒ½æ˜¯å—é…ç½®é¡¹##
##å—é…ç½®é¡¹å¯ä»¥åµŒå¥—ã€‚å†…å±‚å—ç›´æ¥ç»§æ‰¿å¤–å±‚å¿«ï¼Œä¾‹å¦‚ï¼šserverå—é‡Œçš„ä»»æ„é…ç½®éƒ½æ˜¯åŸºäºhttpå—é‡Œçš„å·²æœ‰é…ç½®çš„##
 
##Nginx workerè¿›ç¨‹è¿è¡Œçš„ç”¨æˆ·åŠç”¨æˆ·ç»„ 
#è¯­æ³•ï¼šuser username[groupname]    é»˜è®¤ï¼šuser nobody nobody
#userç”¨äºè®¾ç½®masterè¿›ç¨‹å¯åŠ¨åï¼Œforkå‡ºçš„workerè¿›ç¨‹è¿è¡Œåœ¨é‚£ä¸ªç”¨æˆ·å’Œç”¨æˆ·ç»„ä¸‹ã€‚å½“æŒ‰ç…§<span class="hljs-string">"user username;"</span>è®¾ç½®æ—¶ï¼Œç”¨æˆ·ç»„åä¸ç”¨æˆ·åç›¸åŒã€‚
#è‹¥ç”¨æˆ·åœ¨configureå‘½ä»¤æ‰§è¡Œæ—¶ï¼Œä½¿ç”¨äº†å‚æ•°--user=usergroup å’Œ --group=groupname,æ­¤æ—¶nginx.confå°†ä½¿ç”¨å‚æ•°ä¸­æŒ‡å®šçš„ç”¨æˆ·å’Œç”¨æˆ·ç»„ã€‚
#user  nobody;
 
##Nginx workerè¿›ç¨‹ä¸ªæ•°ï¼šå…¶æ•°é‡ç›´æ¥å½±å“æ€§èƒ½ã€‚
#æ¯ä¸ªworkerè¿›ç¨‹éƒ½æ˜¯å•çº¿ç¨‹çš„è¿›ç¨‹ï¼Œä»–ä»¬ä¼šè°ƒç”¨å„ä¸ªæ¨¡å—ä»¥å®ç°å¤šç§å¤šæ ·çš„åŠŸèƒ½ã€‚å¦‚æœè¿™äº›æ¨¡å—ä¸ä¼šå‡ºç°é˜»å¡å¼çš„è°ƒç”¨ï¼Œé‚£ä¹ˆï¼Œæœ‰å¤šå°‘CPUå†…æ ¸å°±åº”è¯¥é…ç½®å¤šå°‘ä¸ªè¿›ç¨‹ï¼Œåä¹‹ï¼Œæœ‰å¯èƒ½å‡ºç°é˜»å¡å¼è°ƒç”¨ï¼Œé‚£ä¹ˆï¼Œéœ€è¦é…ç½®ç¨å¤šä¸€äº›çš„workerè¿›ç¨‹ã€‚
worker_processes  <span class="hljs-number">1</span>;

##ç»‘å®šNginx workerè¿›ç¨‹åˆ°æŒ‡å®šçš„CPUå†…æ ¸
#è¯­æ³•ï¼šworker_cpu_affinity cpumask[cpumask...]
#ä¾‹å¦‚æœ‰<span class="hljs-number">4</span>ä¸ªCPUå†…æ ¸
#worker_cpu_affinity <span class="hljs-number">1000</span> <span class="hljs-number">0100</span> <span class="hljs-number">0010</span> <span class="hljs-number">0001</span>;
 
##sslç¡¬ä»¶åŠ é€Ÿã€‚
#ç”¨æˆ·å¯ä»¥ç”¨OpneSSLæä¾›çš„å‘½ä»¤æ¥æŸ¥çœ‹æ˜¯å¦æœ‰sslç¡¬ä»¶åŠ é€Ÿè®¾å¤‡ï¼šopenssl engine -t
#ssl_engine device;

##ç³»ç»Ÿè°ƒç”¨gettimeofdayçš„æ‰§è¡Œé¢‘ç‡
#è¯­æ³•ï¼š timer_resolution t

##Nginx workerè¿›ç¨‹ä¼˜å…ˆçº§è®¾ç½®
#è¯­æ³•ï¼š worker_priority nice;
#é»˜è®¤ï¼š worker_priority <span class="hljs-number">0</span>;

##å®ˆæŠ¤è¿›ç¨‹(daemon)ã€‚æ˜¯è„±ç¦»ç»ˆç«¯åœ¨åå°å…è®¸çš„è¿›ç¨‹ã€‚å®ƒè„±ç¦»ç»ˆç«¯æ˜¯ä¸ºäº†é¿å…è¿›ç¨‹æ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä¿¡æ¯åœ¨ä»»ä½•ç»ˆç«¯ä¸Šæ˜¾ç¤ºã€‚è¿™æ ·ä¸€æ¥ï¼Œè¿›ç¨‹ä¹Ÿä¸ä¼šè¢«ä»»ä½•ç»ˆç«¯æ‰€äº§ç”Ÿçš„ä¿¡æ¯æ‰€æ‰“æ–­ã€‚##
##å…³é—­å®ˆæŠ¤è¿›ç¨‹çš„æ¨¡å¼ï¼Œä¹‹æ‰€ä»¥æä¾›è¿™ç§æ¨¡å¼ï¼Œæ˜¯ä¸ºäº†æ–¹ä¾¿è·Ÿè¸ªè°ƒè¯•nginxï¼Œæ¯•ç«Ÿç”¨gdbè°ƒè¯•è¿›ç¨‹æ—¶æœ€ç¹ççš„å°±æ˜¯å¦‚ä½•ç»§ç»­è·Ÿè¿›forkå‡ºçš„å­è¿›ç¨‹äº†ã€‚##
##å¦‚æœç”¨offå…³é—­äº†master_proccessæ–¹å¼ï¼Œå°±ä¸ä¼šforkå‡ºworkerå­è¿›ç¨‹æ¥å¤„ç†è¯·æ±‚ï¼Œè€Œæ˜¯ç”¨masterè¿›ç¨‹è‡ªèº«æ¥å¤„ç†è¯·æ±‚
#daemon off;   #æŸ¥çœ‹æ˜¯å¦ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡ŒNginx é»˜è®¤æ˜¯on
#master_process off; #æ˜¯å¦ä»¥master/workeræ–¹å¼å·¥ä½œ é»˜è®¤æ˜¯on
 
##erroræ—¥å¿—çš„è®¾ç½®#
#è¯­æ³•ï¼š error_log /path/file level;
#é»˜è®¤ï¼š error_log / log/error.log error;
#å½“path/file çš„å€¼ä¸º /dev/nullæ—¶ï¼Œè¿™æ ·å°±ä¸ä¼šè¾“å‡ºä»»ä½•æ—¥å¿—äº†ï¼Œè¿™ä¹Ÿæ˜¯å…³é—­erroræ—¥å¿—çš„å”¯ä¸€æ‰‹æ®µï¼›
#leveçš„å–å€¼èŒƒå›´æ˜¯debugã€infoã€noticeã€warnã€errorã€critã€alertã€emergä»å·¦è‡³å³çº§åˆ«ä¾æ¬¡å¢å¤§ã€‚
#å½“levelçš„çº§åˆ«ä¸ºerroræ—¶ï¼Œerrorã€critã€alertã€emergçº§åˆ«çš„æ—¥å¿—å°±éƒ½ä¼šè¾“å‡ºã€‚å¤§äºç­‰äºè¯¥çº§åˆ«ä¼šè¾“å‡ºï¼Œå°äºè¯¥çº§åˆ«çš„ä¸ä¼šè¾“å‡ºã€‚
#å¦‚æœè®¾å®šçš„æ—¥å¿—çº§åˆ«æ˜¯debugï¼Œåˆ™ä¼šè¾“å‡ºæ‰€æœ‰çš„æ—¥å¿—ï¼Œè¿™ä¸€æ•°æ®é‡ä¼šå¾ˆå¤§ï¼Œéœ€è¦é¢„å…ˆç¡®ä¿/path/fileæ‰€åœ¨çš„ç£ç›˜æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´ã€‚çº§åˆ«è®¾å®šåˆ°debugï¼Œå¿…é¡»åœ¨configureæ—¶åŠ å…¥ --<span class="hljs-keyword">with</span>-debugé…ç½®é¡¹ã€‚
#error_log  logs/error.log;
#error_log  logs/error.log  notice;
#error_log  logs/error.log  info;

##ç”¨æ¥å¸®åŠ©ç”¨æˆ·è·Ÿè¸ªè°ƒè¯•Nginx æ¥æ”¶ä¸¤ä¸ªå‚æ•°stopå’Œabort é€šå¸¸ä¸ä¼šä½¿ç”¨
#stop Nginxçš„ä»£ç æ‰§è¡Œåˆ°è¿™äº›è°ƒè¯•ç‚¹å°±ä¼šå‘å‡ºSIGSTOPä¿¡å·ä»¥ç”¨äºè°ƒè¯•
#abort ä¼šäº§ç”Ÿä¸€ä¸ªcoredumpæ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨gdbæ¥æŸ¥çœ‹Nginxå½“æ—¶çš„å„ç§ä¿¡æ¯
#debug_points point[stop|abort]

##é™åˆ¶coredumpæ ¸å¿ƒè½¬å‚¨æ–‡ä»¶çš„å¤§å°
#Nginxå¼ºåˆ¶åœæ­¢ï¼Œå°†ä¿¡æ¯å­˜å‚¨åœ¨coreæ–‡ä»¶ä¸­ï¼Œä»¥åšè°ƒè¯•ä½¿ç”¨ã€‚ä¸€ä¸ªcoreæ–‡ä»¶å¯èƒ½è¾¾åˆ°å‡ GBï¼Œæ‰€ä»¥éœ€è¦åŠ ä»¥é™åˆ¶
#è¯­æ³•ï¼šworker_rlimit_core size
#worker_rlimit_core <span class="hljs-number">1</span>g;

##æŒ‡å®šcoredumpæ–‡ä»¶ç”Ÿæˆç›®å½•
#è¯­æ³•ï¼šworking_directory path;
#working_directory ./core;

##æŒ‡å®šNginx workerè¿›ç¨‹å¯ä»¥æ‰“å¼€çš„æœ€å¤§å¥æŸ„æè¿°ç¬¦ä¸ªæ•°
#è¯­æ³•ï¼šworker_rlimit_nofile limit

##è®¾ç½®æ¯ä¸ªç”¨æˆ·å‘å¾€Nginxçš„ä¿¡å·é˜Ÿåˆ—çš„å¤§å°ã€‚
#ä¹Ÿå°±æ˜¯è¯´ç”¨æˆ·çš„ä¿¡å·é˜Ÿåˆ—æ»¡äº†ï¼Œå†å‘é€å°±ä¼šè¢«ä¸¢å¤±
#è¯­æ³•ï¼šworker_rlimit_sigpending limit;

##pidæ–‡ä»¶ï¼ˆmasterè¿›ç¨‹IDçš„pidæ–‡ä»¶å­˜æ”¾è·¯å¾„ï¼‰çš„è·¯å¾„
#pid        logs/nginx.pid;

##å®šä¹‰ç¯å¢ƒå˜é‡
#è¯­æ³•ï¼šenv VAR|VAR=VALUE
#env TESTPATH=/tmp/;

##æ˜¯å¦æ‰“å¼€accepté” accept_mutexæ˜¯Nginxçš„è´Ÿè½½å‡è¡¡é”
#è¯­æ³•ï¼š accept_mutex[on|off]
#é»˜è®¤ï¼š accept_mutext on;

##lockæ–‡ä»¶çš„è·¯å¾„
#è¯­æ³•ï¼š lock_file path/file;
#é»˜è®¤ï¼š lock_file logs/nginx.lock;

##ä½¿ç”¨accepté”ååˆ°çœŸæ­£å»ºç«‹è¿æ¥ä¹‹é—´çš„å»¶è¿Ÿæ—¶é—´
#è¯­æ³•ï¼š accept_mutex_delay Nms;
#é»˜è®¤ï¼š accept_mutex_delay <span class="hljs-number">500</span>ms;

##æ‰¹é‡å»ºç«‹æ–°è¿æ¥
#è¯­æ³•ï¼š multi_accept[on|off];
#é»˜è®¤ï¼š multi_accept off;

##é€‰æ‹©äº‹ä»¶æ¨¡å‹ 
#è¯­æ³•ï¼š use[kqueue|rtsig|epoll|/dev/poll|select|poll|eventport];
#é»˜è®¤ï¼š Nginxä¼šè‡ªåŠ¨ä½¿ç”¨æœ€é€‚åˆçš„äº‹ä»¶æ¨¡å‹ã€‚
#å¯¹äºLinuxæ“ä½œç³»ç»Ÿæ¥è¯´ï¼Œ å¯ä¾›é€‰æ‹©çš„äº‹ä»¶é©±åŠ¨æ¨¡å‹æœ‰pollã€ selectã€ epollä¸‰ç§ã€‚ epollå½“
ç„¶æ˜¯æ€§èƒ½æœ€é«˜çš„ä¸€ç§ï¼Œ

events &#123;
 	#ä»…å¯¹æŒ‡å®šçš„å®¢æˆ·ç«¯è¾“å‡ºdebugçº§åˆ«çš„æ—¥å¿—ï¼š è¯­æ³•ï¼šdebug_connection[IP|CIDR]
 	#è¿™ä¸ªè®¾ç½®é¡¹å®é™…ä¸Šå±äºäº‹ä»¶ç±»é…ç½®ï¼Œå› æ­¤å¿…é¡»æ”¾åœ¨events&#123;â€¦â€¦&#125;ä¸­æ‰ä¼šç”Ÿæ•ˆã€‚å®ƒçš„å€¼å¯ä»¥æ˜¯IPåœ°å€æˆ–è€…æ˜¯CIRDåœ°å€ã€‚
 	#debug_connection <span class="hljs-number">10.224</span><span class="hljs-number">.66</span><span class="hljs-number">.14</span>;  #æˆ–æ˜¯debug_connection <span class="hljs-number">10.224</span><span class="hljs-number">.57</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span>
 	#è¿™æ ·ï¼Œä»…ä»…ä»¥ä¸ŠIPåœ°å€çš„è¯·æ±‚æ‰ä¼šè¾“å‡ºdebugçº§åˆ«çš„æ—¥å¿—ï¼Œå…¶ä»–è¯·æ±‚ä»ç„¶æ²¿ç”¨error_logä¸­é…ç½®çš„æ—¥å¿—çº§åˆ«ã€‚
 	#æ³¨æ„ï¼šåœ¨ä½¿ç”¨debug_connectionå‰ï¼Œéœ€ç¡®ä¿åœ¨æ‰§è¡Œconfigureæ—¶å·²ç»åŠ å…¥äº†--<span class="hljs-keyword">with</span>-debugå‚æ•°ï¼Œå¦åˆ™ä¸ä¼šç”Ÿæ•ˆã€‚
 	##æ¯ä¸ªworkerçš„æœ€å¤§è¿æ¥æ•°
	worker_connections  <span class="hljs-number">1024</span>;
&#125;
 
##æ ¸å¿ƒè½¬å‚¨(coredump):åœ¨Linuxç³»ç»Ÿä¸­ï¼Œå½“è¿›ç¨‹å‘ç”Ÿé”™è¯¯æˆ–æ”¶åˆ°ä¿¡å·è€Œç»ˆæ­¢æ—¶ï¼Œç³»ç»Ÿä¼šå°†è¿›ç¨‹æ‰§è¡Œæ—¶çš„å†…å­˜å†…å®¹(æ ¸å¿ƒæ˜ åƒ)å†™å…¥ä¸€ä¸ªæ–‡ä»¶(coreæ–‡ä»¶)ï¼Œä»¥ä½œä¸ºè°ƒè¯•åªç”¨ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„æ ¸å¿ƒè½¬å‚¨(coredump).
 
http &#123;
	##åµŒå…¥å…¶ä»–é…ç½®æ–‡ä»¶ è¯­æ³•ï¼šinclude /path/file
	#å‚æ•°æ—¢å¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ï¼ˆç›¸å¯¹äºNginxçš„é…ç½®ç›®å½•ï¼Œå³nginx.confæ‰€åœ¨çš„ç›®å½•ï¼‰
    include       mime.types;
    default_type  application/octet-stream;
 
    #log_format  main  <span class="hljs-string">'$remote_addr - $remote_user [$time_local] "$request" '</span>
    #                  <span class="hljs-string">'$status $body_bytes_sent "$http_referer" '</span>
    #                  <span class="hljs-string">'"$http_user_agent" "$http_x_forwarded_for"'</span>;
 
    #access_log  logs/access.log  main;
 
    sendfile        on;
    #tcp_nopush     on;
 
    #keepalive_timeout  <span class="hljs-number">0</span>;
    keepalive_timeout  <span class="hljs-number">65</span>;
 
    #gzip  on;
 
    server &#123;
		##listenç›‘å¬çš„ç«¯å£
		#è¯­æ³•ï¼šlisten address:port [ default(deprecated <span class="hljs-keyword">in</span> <span class="hljs-number">0.8</span><span class="hljs-number">.21</span>) | default_server | [ backlog=num | rcvbuf=size | sndbuf=size | accept_filter=filter | deferred | bind | ssl ] ]
		#default_server: å¦‚æœæ²¡æœ‰è®¾ç½®è¿™ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆå°†ä¼šä»¥åœ¨nginx.confä¸­æ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªserverå—ä½œä¸ºé»˜è®¤serverå—
		#backlog=numï¼šè¡¨ç¤ºTCPä¸­backlogé˜Ÿåˆ—çš„å¤§å°ï¼Œé»˜è®¤<span class="hljs-number">-1</span>ï¼Œè¡¨ç¤ºä¸äºˆè®¾ç½®
		#rcvbuf=sizeï¼š è®¾ç½®ç›‘å¬å¥æŸ„çš„SO_RCVBUFå‚æ•°ã€‚
		#sndbuf=sizeï¼š è®¾ç½®ç›‘å¬å¥æŸ„çš„SO_SNDBUFå‚æ•°ã€‚
		#accept_filterï¼š è®¾ç½®acceptè¿‡æ»¤å™¨ï¼Œ åªå¯¹FreeBSDæ“ä½œç³»ç»Ÿæœ‰ç”¨
		#bindï¼šç»‘å®šå½“å‰ç«¯å£/åœ°å€ï¼Œåªæœ‰åŒæ—¶å¯¹ä¸€ä¸ªç«¯å£ç›‘å¬å¤šä¸ªåœ°å€æ—¶
æ‰ä¼šç”Ÿæ•ˆã€‚
		#sslï¼š åœ¨å½“å‰ç›‘å¬çš„ç«¯å£ä¸Šå»ºç«‹çš„è¿æ¥å¿…é¡»åŸºäºSSLåè®®ã€‚
		listen       <span class="hljs-number">8080</span>;
 
		#ä¸»æœºåç§°ï¼šå…¶åå¯ä»¥è·Ÿå¤šä¸ªä¸»æœºåç§°ï¼Œå¼€å§‹å¤„ç†ä¸€ä¸ªHTTPè¯·æ±‚æ—¶ï¼Œnginxä¼šå–å‡ºheaderå¤´ä¸­çš„Hostï¼Œä¸æ¯ä¸ªserverä¸­çš„server_nameè¿›è¡ŒåŒ¹é…ï¼Œä»¥æ­¤å†³å®šåˆ°åº•ç”±é‚£ä¸€ä¸ªserveræ¥å¤„ç†è¿™ä¸ªè¯·æ±‚ã€‚æœ‰å¯èƒ½ä¸€ä¸ªHostä¸å¤šä¸ªserverå—ä¸­çš„server_nameéƒ½åŒ¹é…ï¼Œè¿™æ—¶ä¼šæ ¹æ®åŒ¹é…ä¼˜å…ˆçº§æ¥é€‰æ‹©å®é™…å¤„ç†çš„serverå—ã€‚
	 	server_name  localhost;
 
        #charset koi8-r;
 
        #access_log  logs/host.access.log  main;
 
        #location / &#123;
        #    root   html;
        
        	##ç”¨æ¥è®¾ç½®æ–‡ä»¶èµ„æºè·¯å¾„çš„
			#è¯­æ³•ï¼š alias path;
			#é…ç½®å—ï¼š location
		#	alias usr/local/nginx/conf/;
        #    index  index.html index.htm;
        #&#125;
        
        ##è‹¥è¯·æ±‚çš„URIæ˜¯/download/index/test.htmlï¼Œ é‚£æœåŠ¡å™¨å°±ä¼šè¿”å›æœåŠ¡å™¨ä¸Šoptwebhtmlã€download/index/test.htmlæ–‡ä»¶çš„å†…å®¹ã€‚
        #location /download/ &#123;
		#	root optwebhtml;
		#&#125;
		

 
		##location è¯­æ³•ï¼š location [=|~|~*|^~|@]/uri/ &#123; ... &#125;
		#æ³¨æ„ï¼šlocationæ—¶æœ‰é¡ºåºçš„ï¼Œå½“ä¸€ä¸ªè¯·æ±‚æœ‰å¯èƒ½åŒ¹é…å¤šä¸ªlocationæ—¶ï¼Œå®é™…ä¸Šè¿™ä¸ªè¯·æ±‚ä¼šè¢«ç¬¬ä¸€ä¸ªlocationå¤„ç†ã€‚
		location / &#123;
			proxy_pass http:<span class="hljs-comment">//192.168.1.60;</span>
   	 	&#125;
   	 	
   	 	##æŒ‰HTTPæ–¹æ³•åé™åˆ¶ç”¨æˆ·è¯·æ±‚
		#è¯­æ³•ï¼š limit_except method...&#123;...&#125;
		#é…ç½®å—ï¼š location
		#æ–¹æ³•åå¯å–å€¼åŒ…æ‹¬ï¼š GETã€HEADã€ POSTã€ PUTã€ DELETEã€ MKCOLã€ COPYã€ MOVEã€ OPTIONSã€ PROPFINDã€PROPPATCHã€ LOCKã€ UNLOCKæˆ–è€…PATCHã€‚ 
		#limit_except GET &#123;
		#	allow <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span>/<span class="hljs-number">32</span>;
		#	deny all;
		#&#125;
		#æ³¨æ„ï¼Œ å…è®¸GETæ–¹æ³•å°±æ„å‘³ç€ä¹Ÿå…è®¸HEADæ–¹æ³•ã€‚ å› æ­¤ï¼Œ ä¸Šé¢è¿™æ®µä»£ç è¡¨ç¤ºçš„æ˜¯ç¦æ­¢
GETæ–¹æ³•å’ŒHEADæ–¹æ³•ï¼Œ ä½†å…¶ä»–HTTPæ–¹æ³•æ˜¯å…è®¸çš„ã€‚
		
		
		
 
		##æ ¹æ®HTTPè¿”å›ç é‡å®šå‘é¡µé¢
		#è¯­æ³•ï¼šerror_page <span class="hljs-keyword">code</span>[<span class="hljs-keyword">code</span>...][=|=answer-<span class="hljs-keyword">code</span>]uri|@named_location
		#é…ç½®å—ï¼š httpã€ serverã€ locationã€ <span class="hljs-keyword">if</span>
        #error_page  <span class="hljs-number">404</span>              /<span class="hljs-number">404.</span>html;
        error_page   <span class="hljs-number">500</span> <span class="hljs-number">502</span> <span class="hljs-number">503</span> <span class="hljs-number">504</span>  /<span class="hljs-number">50</span>x.html;
        
        ##æ˜¯å¦å…è®¸é€’å½’ä½¿ç”¨error_page
		#è¯­æ³•ï¼š recursive_error_pages[on|off];
		#é»˜è®¤ï¼š recursive_error_pages off;
		#é…ç½®å—ï¼š httpã€ serverã€ location
		
		##å°è¯•æŒ‰ç…§é¡ºåºè®¿é—®æ¯ä¸€ä¸ªpathï¼Œ å¦‚æœå¯ä»¥æœ‰æ•ˆåœ°è¯»å–ï¼Œ å°±ç›´æ¥å‘ç”¨æˆ·è¿”å›è¿™ä¸ªpathå¯¹åº”çš„æ–‡ä»¶ç»“æŸè¯·æ±‚ï¼Œ å¦åˆ™ç»§ç»­å‘ä¸‹è®¿é—®ã€‚ å¦‚æœæ‰€æœ‰çš„pathéƒ½æ‰¾ä¸åˆ°æœ‰æ•ˆçš„æ–‡ä»¶ï¼Œ å°±é‡å®šå‘åˆ°æœ€åçš„å‚æ•°
uriä¸Šã€‚ 
		#å› æ­¤æœ€åä¸€ä¸ªpathå¿…é¡»æœ‰urlå‚æ•°
		#è¯­æ³•ï¼š try_files path1[path2]uri;
		#é…ç½®å—ï¼š serverã€ location
        
        location = /<span class="hljs-number">50</span>x.html &#123;
            root   html;
        &#125;
        
        ##ä¸ºäº†æé«˜å¿«é€Ÿå¯»æ‰¾åˆ°ç›¸åº”server nameçš„èƒ½åŠ›ï¼Œ Nginxä½¿ç”¨æ•£åˆ—è¡¨æ¥å­˜å‚¨server nameã€‚
		#server_names_hash_bucket_sizeè®¾ç½®äº†æ¯ä¸ªæ•£åˆ—æ¡¶å ç”¨çš„å†…å­˜å¤§å°ã€‚
    	#è¯­æ³•ï¼š server_names_hash_bucket_size size;
		#é»˜è®¤ï¼š server_names_hash_bucket_size <span class="hljs-number">32</span>|<span class="hljs-number">64</span>|<span class="hljs-number">128</span>;
		#é…ç½®å—ï¼š httpã€ serverã€ location
	
		##server_names_hash_max_sizeä¼šå½±å“æ•£åˆ—è¡¨çš„å†²çªç‡ã€‚ server_names_hash_max_sizeè¶Šå¤§ï¼Œ
æ¶ˆè€—çš„å†…å­˜å°±è¶Šå¤šï¼Œ ä½†æ•£åˆ—keyçš„å†²çªç‡åˆ™ä¼šé™ä½ï¼Œ æ£€ç´¢é€Ÿåº¦ä¹Ÿæ›´å¿«ã€‚
		#è¯­æ³•ï¼š server_names_hash_max_size size;
		#é»˜è®¤ï¼š server_names_hash_max_size <span class="hljs-number">512</span>;
		#é…ç½®å—ï¼š httpã€ serverã€ location
	
		##é‡å®šå‘ä¸»æœºåç§°çš„å¤„ç†
		#è¯¥é…ç½®éœ€è¦é…åˆserver_nameä½¿ç”¨ã€‚ åœ¨ä½¿ç”¨onæ‰“å¼€æ—¶ï¼Œ è¡¨ç¤ºåœ¨é‡å®šå‘è¯·æ±‚æ—¶ä¼šä½¿ç”¨
server_nameé‡Œé…ç½®çš„ç¬¬ä¸€ä¸ªä¸»æœºåä»£æ›¿åŸå…ˆè¯·æ±‚ä¸­çš„Hostå¤´éƒ¨ï¼Œ è€Œä½¿ç”¨offå…³é—­æ—¶ï¼Œ è¡¨ç¤ºåœ¨é‡
å®šå‘è¯·æ±‚æ—¶ä½¿ç”¨è¯·æ±‚æœ¬èº«çš„Hostå¤´éƒ¨ã€‚
		#è¯­æ³•ï¼š server_name_in_redirect on|off;
		#é»˜è®¤ï¼š server_name_in_redirect on;
		#é…ç½®å—ï¼š httpã€ serveræˆ–è€…location
		
		##HTTPåŒ…ä½“åªå­˜å‚¨åˆ°ç£ç›˜æ–‡ä»¶ä¸­
		#å½“å€¼ä¸ºéoffæ—¶ï¼Œ ç”¨æˆ·è¯·æ±‚ä¸­çš„HTTPåŒ…ä½“ä¸€å¾‹å­˜å‚¨åˆ°ç£ç›˜æ–‡ä»¶ä¸­ï¼Œ å³ä½¿åªæœ‰<span class="hljs-number">0</span>å­—èŠ‚ä¹Ÿä¼šå­˜
å‚¨ä¸ºæ–‡ä»¶ã€‚ å½“è¯·æ±‚ç»“æŸæ—¶ï¼Œ å¦‚æœé…ç½®ä¸ºonï¼Œ åˆ™è¿™ä¸ªæ–‡ä»¶ä¸ä¼šè¢«åˆ é™¤ï¼ˆè¯¥é…ç½®ä¸€èˆ¬ç”¨äºè°ƒè¯•ã€
å®šä½é—®é¢˜ï¼‰ ï¼Œ ä½†å¦‚æœé…ç½®ä¸ºcleanï¼Œ åˆ™ä¼šåˆ é™¤è¯¥æ–‡ä»¶ã€‚
		#è¯­æ³•ï¼š client_body_in_file_only on|clean|off;
		#é»˜è®¤ï¼š client_body_in_file_only off;
		#é…ç½®å—ï¼š httpã€ serverã€ location
		
		##HTTPåŒ…ä½“å°½é‡å†™å…¥åˆ°ä¸€ä¸ªå†…å­˜bufferä¸­
		#ç”¨æˆ·è¯·æ±‚ä¸­çš„HTTPåŒ…ä½“ä¸€å¾‹å­˜å‚¨åˆ°å†…å­˜bufferä¸­ã€‚ å½“ç„¶ï¼Œ å¦‚æœHTTPåŒ…ä½“çš„å¤§å°è¶…è¿‡äº†
ä¸‹é¢client_body_buffer_sizeè®¾ç½®çš„å€¼ï¼Œ åŒ…ä½“è¿˜æ˜¯ä¼šå†™å…¥åˆ°ç£ç›˜æ–‡ä»¶ä¸­ã€‚
		#è¯­æ³•ï¼š client_body_in_single_buffer on|off;
		#é»˜è®¤ï¼š client_body_in_single_buffer off;
		#é…ç½®å—ï¼š httpã€ serverã€ location
		
		##å­˜å‚¨HTTPå¤´éƒ¨çš„å†…å­˜bufferå¤§å°
		#è¯­æ³•ï¼š client_header_buffer_size size;
		#é»˜è®¤ï¼š client_header_buffer_size <span class="hljs-number">1</span>k;
		#é…ç½®å—ï¼š httpã€ server
		
		##å­˜å‚¨è¶…å¤§HTTPå¤´éƒ¨çš„å†…å­˜bufferå¤§å°
		#è¯­æ³•ï¼š large_client_header_buffers number size;
		#é»˜è®¤ï¼š large_client_header_buffers <span class="hljs-number">48</span>k;
		#é…ç½®å—ï¼š httpã€ server
		
		##å­˜å‚¨HTTPåŒ…ä½“çš„å†…å­˜å¤§å°
		#è¯­æ³•ï¼š client_body_buffer_siz size
		#é»˜è®¤ï¼š client_body_buffer_siz <span class="hljs-number">8</span>k/<span class="hljs-number">16</span>k;
		#é…ç½®å—ï¼šhttpã€ serverã€ location
		
		##HTTPåŒ…ä½“çš„ä¸´æ—¶å­˜æ”¾ç›®å½•
		#è¯­æ³•ï¼š client_body_temp_path dir-path[level1[level2[level3]]]
		#é»˜è®¤ï¼š client_body_temp_path client_body_temp;
		#é…ç½®å—ï¼š httpã€ serverã€ location
		
		##æŒ‡å®šå†…å­˜æ± çš„åˆå§‹å¤§å°
		#è¯­æ³•ï¼š connection_pool_size size;
		#é»˜è®¤ï¼š connection_pool_size <span class="hljs-number">256</span>;
		#é…ç½®å—ï¼š httpã€ server
		
		##æŒ‡å®šæ¯ä¸ªè¯·æ±‚çš„å†…å­˜æ± å¤§å°
		#è¯­æ³•ï¼š request_pool_size size;
		#é»˜è®¤ï¼š request_pool_size <span class="hljs-number">4</span>k;
		#é…ç½®å—ï¼š httpã€ server
		
		##è¯»å–HTTPå¤´éƒ¨çš„è¶…æ—¶æ—¶é—´
		#è¯­æ³•ï¼š client_header_timeout timeï¼ˆé»˜è®¤å•ä½ï¼š ç§’ï¼‰ ;
		#é»˜è®¤ï¼š client_header_timeout <span class="hljs-number">60</span>;
		#é…ç½®å—ï¼š httpã€ serverã€ location
		
		##è¯»å–HTTPåŒ…ä½“çš„è¶…æ—¶æ—¶é—´
		#è¯­æ³•ï¼š client_body_timeout timeï¼ˆé»˜è®¤å•ä½ï¼š ç§’ï¼‰ ï¼›
		#é»˜è®¤ï¼š client_body_timeout <span class="hljs-number">60</span>;
		#é…ç½®å—ï¼š httpã€ serverã€ location
		
		##å‘é€å“åº”çš„è¶…æ—¶æ—¶é—´
		#è¯­æ³•ï¼š send_timeout time;
		#é»˜è®¤ï¼š send_timeout <span class="hljs-number">60</span>;
		#é…ç½®å—ï¼š httpã€ serverã€ location
		
		##è¿æ¥è¶…æ—¶åå°†é€šè¿‡å‘å®¢æˆ·ç«¯å‘é€RSTåŒ…æ¥ç›´æ¥é‡ç½®è¿æ¥
		#è¯­æ³•ï¼š reset_timeout_connection on|off;
		#é»˜è®¤ï¼š reset_timeout_connection off;
		#é…ç½®å—ï¼š httpã€ serverã€ location
		
		##è¯¥é…ç½®æ§åˆ¶Nginxå…³é—­ç”¨æˆ·è¿æ¥çš„æ–¹å¼ã€‚
		#è¯­æ³•ï¼š lingering_close off|on|always;
		#é»˜è®¤ï¼š lingering_close on;
		#é…ç½®å—ï¼š httpã€ serverã€ location
		
		##lingering_closeå¯ç”¨åï¼Œ è¿™ä¸ªé…ç½®é¡¹å¯¹äºä¸Šä¼ å¤§æ–‡ä»¶å¾ˆæœ‰ç”¨
		#è¯­æ³•ï¼š lingering_time time;
		#é»˜è®¤ï¼š lingering_time <span class="hljs-number">30</span>s;é…ç½®å—ï¼š httpã€ serverã€ location
		
		##lingering_closeç”Ÿæ•ˆåï¼Œ åœ¨å…³é—­è¿æ¥å‰ï¼Œ ä¼šæ£€æµ‹æ˜¯å¦æœ‰ç”¨æˆ·å‘é€çš„æ•°æ®åˆ°è¾¾æœåŠ¡å™¨ï¼Œ å¦‚æœ
è¶…è¿‡lingering_timeoutæ—¶é—´åè¿˜æ²¡æœ‰æ•°æ®å¯è¯»ï¼Œ å°±ç›´æ¥å…³é—­è¿æ¥ï¼› å¦åˆ™ï¼Œ å¿…é¡»åœ¨è¯»å–å®Œè¿æ¥ç¼“
å†²åŒºä¸Šçš„æ•°æ®å¹¶ä¸¢å¼ƒæ‰åæ‰ä¼šå…³é—­è¿æ¥ã€‚
		#è¯­æ³•ï¼š lingering_timeout time;
		#é»˜è®¤ï¼š lingering_timeout <span class="hljs-number">5</span>s;
		#é…ç½®å—ï¼š httpã€ serverã€ location
		
		##å¯¹æŸäº›æµè§ˆå™¨ç¦ç”¨keepaliveåŠŸèƒ½
		#è¯­æ³•ï¼š keepalive_disable[msie6|safari|none]...
		#é»˜è®¤ï¼š keepalive_disablemsie6 safari
		#é…ç½®å—ï¼š httpã€ serverã€ location
		
		##keepaliveè¶…æ—¶æ—¶é—´
		#è¯­æ³•ï¼š keepalive_timeout timeï¼ˆé»˜è®¤å•ä½ï¼š ç§’ï¼‰ ;
		#é»˜è®¤ï¼š keepalive_timeout <span class="hljs-number">75</span>;
		#é…ç½®å—ï¼š httpã€ serverã€ location
		
		##ä¸€ä¸ªkeepaliveé•¿è¿æ¥ä¸Šå…è®¸æ‰¿è½½çš„è¯·æ±‚æœ€å¤§æ•°
		#è¯­æ³•ï¼š keepalive_requests n;
		#é»˜è®¤ï¼š keepalive_requests <span class="hljs-number">100</span>;
		#é…ç½®å—ï¼š httpã€ serverã€ location
		
		##ç¡®å®šå¯¹keepaliveè¿æ¥æ˜¯å¦ä½¿ç”¨TCP_NODELAYé€‰é¡¹
		#è¯­æ³•ï¼š tcp_nodelay on|off;
		#é»˜è®¤ï¼š tcp_nodelay on;
		#é…ç½®å—ï¼š httpã€ serverã€ location
		
		##åœ¨æ‰“å¼€sendfileé€‰é¡¹æ—¶ï¼Œ ç¡®å®šæ˜¯å¦å¼€å¯FreeBSDç³»ç»Ÿä¸Šçš„TCP_NOPUSHæˆ–Linuxç³»ç»Ÿä¸Šçš„
TCP_CORKåŠŸèƒ½ã€‚ æ‰“å¼€tcp_nopushåï¼Œ å°†ä¼šåœ¨å‘é€å“åº”æ—¶æŠŠæ•´ä¸ªå“åº”åŒ…å¤´æ”¾åˆ°ä¸€ä¸ªTCPåŒ…ä¸­
å‘é€ã€‚
		#è¯­æ³•ï¼š tcp_nopush on|off;
		#é»˜è®¤ï¼š tcp_nopush off;
		#é…ç½®å—ï¼š httpã€ serverã€ location
		
		##HTTPè¯·æ±‚åŒ…ä½“çš„æœ€å¤§å€¼
		#è¯­æ³•ï¼š client_max_body_size size;
		#é»˜è®¤ï¼š client_max_body_size <span class="hljs-number">1</span>m;
		#é…ç½®å—ï¼š httpã€ serverã€ location
		
		##å¯¹è¯·æ±‚çš„é™é€Ÿ
		#æ­¤é…ç½®æ˜¯å¯¹å®¢æˆ·ç«¯è¯·æ±‚é™åˆ¶æ¯ç§’ä¼ è¾“çš„å­—èŠ‚æ•°ã€‚é»˜è®¤å‚æ•°ä¸º<span class="hljs-number">0</span>ï¼Œ è¡¨ç¤ºä¸é™é€Ÿã€‚
		#è¯­æ³•ï¼š limit_rate speed;
		#é»˜è®¤ï¼š limit_rate <span class="hljs-number">0</span>;
		#é…ç½®å—ï¼š httpã€ serverã€ locationã€ <span class="hljs-keyword">if</span>
		
		##Nginxå‘å®¢æˆ·ç«¯å‘é€çš„å“åº”é•¿åº¦è¶…è¿‡limit_rate_afteråæ‰å¼€å§‹é™é€Ÿ
		#è¯­æ³•ï¼š limit_rate_after time;
		#é»˜è®¤ï¼š limit_rate_after <span class="hljs-number">1</span>m;
		#é…ç½®å—ï¼š httpã€ serverã€ locationã€ <span class="hljs-keyword">if</span>
		
		##sendfileç³»ç»Ÿè°ƒç”¨
		#è¯­æ³•ï¼š sendfile on|off;
		#é»˜è®¤ï¼š sendfile off;
		#é…ç½®å—ï¼š httpã€ serverã€ location
		
		##AIOç³»ç»Ÿè°ƒç”¨
        #è¯­æ³•ï¼š aio on|off;
        #é»˜è®¤ï¼š aio off;
        #é…ç½®å—ï¼š httpã€ serverã€ location
        
        ##æ­¤é…ç½®é¡¹åœ¨FreeBSDå’ŒLinuxç³»ç»Ÿä¸Šä½¿ç”¨O_DIRECTé€‰é¡¹å»è¯»å–æ–‡ä»¶ï¼Œ ç¼“å†²åŒºå¤§å°ä¸ºsizeï¼Œ
é€šå¸¸å¯¹å¤§æ–‡ä»¶çš„è¯»å–é€Ÿåº¦æœ‰ä¼˜åŒ–ä½œç”¨ã€‚ 
		#æ³¨æ„ï¼Œ å®ƒä¸sendfileåŠŸèƒ½æ˜¯äº’æ–¥çš„ã€‚
        #è¯­æ³•ï¼š directio size|off;
        #é»˜è®¤ï¼š directio off;
        #é…ç½®å—ï¼š httpã€ serverã€ location
		
		##æŒ‡å®šä»¥directioæ–¹å¼è¯»å–æ–‡ä»¶æ—¶çš„å¯¹é½æ–¹å¼
		#å®ƒä¸directioé…åˆä½¿ç”¨
        #è¯­æ³•ï¼š directio_alignment size;
        #é»˜è®¤ï¼š directio_alignment <span class="hljs-number">512</span>;
        #é…ç½®å—ï¼š httpã€ serverã€ location
		
		##æ‰“å¼€æ–‡ä»¶ç¼“å­˜
        #è¯­æ³•ï¼š open_file_cache max=N[inactive=time]|off;
        #é»˜è®¤ï¼š open_file_cache off;
        #é…ç½®å—ï¼š httpã€ serverã€ location
        
        ##æ˜¯å¦ç¼“å­˜æ‰“å¼€æ–‡ä»¶é”™è¯¯çš„ä¿¡æ¯
		#è¯­æ³•ï¼š open_file_cache_errors on|off;
		#é»˜è®¤ï¼š open_file_cache_errors off;
		#é…ç½®å—ï¼š httpã€ serverã€ location
		
		##ä¸è¢«æ·˜æ±°çš„æœ€å°è®¿é—®æ¬¡æ•°
		#å®ƒä¸open_file_cacheä¸­çš„inactiveå‚æ•°é…åˆä½¿ç”¨
		#è¯­æ³•ï¼š open_file_cache_min_uses number;
		#é»˜è®¤ï¼š open_file_cache_min_uses <span class="hljs-number">1</span>;
		#é…ç½®å—ï¼š httpã€ serverã€ location
		
		##æ£€éªŒç¼“å­˜ä¸­å…ƒç´ æœ‰æ•ˆæ€§çš„é¢‘ç‡
		#é»˜è®¤ä¸ºæ¯<span class="hljs-number">60</span>ç§’æ£€æŸ¥ä¸€æ¬¡ç¼“å­˜ä¸­çš„å…ƒç´ æ˜¯å¦ä»æœ‰æ•ˆ
		#è¯­æ³•ï¼š open_file_cache_valid time;
		#é»˜è®¤ï¼š open_file_cache_valid <span class="hljs-number">60</span>s;
		#é…ç½®å—ï¼š httpã€ serverã€ location
		
		##å¿½ç•¥ä¸åˆæ³•çš„HTTPå¤´éƒ¨
		#è¯­æ³•ï¼š ignore_invalid_headers on|off;
		#é»˜è®¤ï¼š ignore_invalid_headers on;
		#é…ç½®å—ï¼š httpã€ server
		
		##HTTPå¤´éƒ¨æ˜¯å¦å…è®¸ä¸‹åˆ’çº¿
		#è¯­æ³•ï¼š underscores_in_headers on|off;
		#é»˜è®¤ï¼š underscores_in_headers off;
		#é…ç½®å—ï¼š httpã€ server
		
		##å¯¹If-Modified-Sinceå¤´éƒ¨çš„å¤„ç†ç­–ç•¥
        #è¯­æ³•ï¼š if_modified_since[off|exact|before];
        #é»˜è®¤ï¼š if_modified_since exact;
        #é…ç½®å—ï¼š httpã€ serverã€ location
        
        ##æ–‡ä»¶æœªæ‰¾åˆ°æ—¶æ˜¯å¦è®°å½•åˆ°erroræ—¥å¿—
        #è¯­æ³•ï¼š log_not_found on|off;
        #é»˜è®¤ï¼š log_not_found on;
        #é…ç½®å—ï¼š httpã€ serverã€ location
        
        ##æ˜¯å¦åˆå¹¶ç›¸é‚»çš„â€œâ€
        #è¯­æ³•ï¼š merge_slashes on|off;
        #é»˜è®¤ï¼š merge_slashes on;
        #é…ç½®å—ï¼š httpã€ serverã€ location
		
		##DNSè§£æåœ°å€
        #è¯­æ³•ï¼š resolver address...;
        #é…ç½®å—ï¼š httpã€ serverã€ location
        
        ##DNSè§£æçš„è¶…æ—¶æ—¶é—´
        #è¯­æ³•ï¼š resolver_timeout time;
        #é»˜è®¤ï¼š resolver_timeout <span class="hljs-number">30</span>s;
        #é…ç½®å—ï¼š httpã€ serverã€ location
        
        ##è¿”å›é”™è¯¯é¡µé¢æ—¶æ˜¯å¦åœ¨Serverä¸­æ³¨æ˜Nginxç‰ˆæœ¬
        #è¯­æ³•ï¼š server_tokens on|off;
        #é»˜è®¤ï¼š server_tokens on;
        #é…ç½®å—ï¼š httpã€ serverã€ location
        
--------------------è´Ÿè½½å‡è¡¡ã€åå‘ä»£ç†----------------------------        
        
        ##upstreamå—ï¼Œå®šä¹‰ä¸€ä¸ªä¸Šæ¸¸æœåŠ¡å™¨é›†ç¾¤
		#è¯­æ³•ï¼š upstream name&#123;...&#125;
		#é…ç½®å—ï¼š http
		upstream backserver&#123;
			##ä¸Šæ¸¸æœåŠ¡åå¯ä»¥ä¸ºåŸŸåã€ipç«¯å£
			#å‚æ•°è¯´æ˜ï¼š
			- weight=<span class="hljs-number">1</span> æƒé‡ï¼›
			- max_fails=<span class="hljs-number">1</span>ä¸fail_time=<span class="hljs-number">10</span>sé…åˆä½¿ç”¨ï¼Œè¡¨ç¤ºåœ¨<span class="hljs-number">10</span>så†…ï¼Œä¸Šæ¸¸æœåŠ¡å™¨å¤±è´¥æ¬¡æ•°è¶…è¿‡<span class="hljs-number">1</span>æ¬¡ï¼Œåˆ™ä¸å¯ç”¨
			- downï¼šè¡¨ç¤ºæ‰€åœ¨çš„ä¸Šæ¸¸æœåŠ¡å™¨æ°¸ä¹…ä¸‹çº¿ï¼Œåªèƒ½ä½¿ç”¨ip_hashé…ç½®é¡¹æ—¶æ‰èƒ½ç”¨
			- backupï¼šåœ¨ä½¿ç”¨ip_hashé…ç½®é¡¹æ—¶å®ƒæ˜¯æ— æ•ˆçš„ï¼ŒæŒ‡å¤‡ä»½æœåŠ¡å™¨ï¼Œè¡¨ç¤ºæ‰€æœ‰éå¤‡ä»½æœåŠ¡å™¨éƒ½å¤±æ•ˆï¼Œæ‰ä¼šæ‰§è¡Œ
			server <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span>:<span class="hljs-number">90</span>;
			
			##ip_hash æœ‰æ•ˆåœ°ç®¡ç†é›†ç¾¤ä¸­ç›¸åŒçš„ç¼“å­˜ä¿¡æ¯
			#ip_hashä¸weighté…ç½®ä¸å¯åŒæ—¶ä½¿ç”¨
			ip_hash;
		&#125;
		
		##åå‘ä»£ç†çš„åŸºæœ¬é…ç½®
		#proxy_pass
		#è¯­æ³•ï¼š proxy_pass URL;
		#é…ç½®å—ï¼š locationã€ <span class="hljs-keyword">if</span>
		location / &#123;
			proxy_pass http:<span class="hljs-comment">//backserver; #é…ç½®è´Ÿè½½å‡è¡¡</span>
			#proxy_pass http:<span class="hljs-comment">//localhost:8080/test</span>
			
			#æ³¨ï¼šé»˜è®¤æƒ…å†µï¼Œåå‘ä»£ç†ä¸ä¼šè½¬å‘è¯·æ±‚ä¸­çš„Hostå¤´éƒ¨ï¼Œå¦‚éœ€ï¼Œæ·»åŠ 
			proxy_set_header Host $host;
			
			#proxy_methodè¡¨ç¤ºè½¬å‘æ—¶çš„åè®®æ–¹æ³•åã€‚
            #è¯­æ³•ï¼š proxy_method method;
			#é…ç½®å—ï¼š httpã€ serverã€ location
			proxy_method POST; #å‘æ¥getè¯·æ±‚ï¼Œä¹Ÿä¼šè½¬åŒ–æˆPOST
			
			#proxy_hide_header æŒ‡å®šHTTPå¤´éƒ¨å­—æ®µå“ªäº›å¯ä»¥è½¬å‘ï¼Œé»˜è®¤ä¸ä¼šè½¬å‘
			#è¯­æ³•ï¼š proxy_hide_header the_header;
			#é…ç½®å—ï¼š httpã€ serverã€ location
			proxy_hide_header Cache-Control;
			proxy_hide_header MicrosoftOfficeWebServer;
			
			#proxy_pass_headerï¼šå°†åŸæ¥ç¦æ­¢è½¬å‘çš„headerè®¾ç½®ä¸ºå…è®¸
è½¬å‘
			#è¯­æ³•ï¼š proxy_pass_header the_header;
			#é…ç½®å—ï¼š httpã€ serverã€ location
			proxy_pass_header X-Accel-Redirect;
			
			#proxy_pass_request_bodyï¼šç¡®å®šæ˜¯å¦å‘ä¸Šæ¸¸æœåŠ¡å™¨å‘é€HTTPåŒ…ä½“éƒ¨åˆ†
			#è¯­æ³•ï¼š proxy_pass_request_body on|off;
			#é»˜è®¤ï¼š proxy_pass_request_body on;
			#é…ç½®å—ï¼š httpã€ serverã€ location
			proxy_pass_request_body off;
			
			#proxy_pass_request_headers:ç¡®å®šæ˜¯å¦è½¬å‘HTTPå¤´éƒ¨
			#è¯­æ³•ï¼š proxy_pass_request_headers on|off;
			#é»˜è®¤ï¼š proxy_pass_request_headers on;
			#é…ç½®å—ï¼š httpã€ serverã€ location
			
			#proxy_redirect:å½“ä¸Šæ¸¸æœåŠ¡å™¨è¿”å›çš„å“åº”æ˜¯é‡å®šå‘æˆ–åˆ·æ–°è¯·æ±‚ï¼ˆ<span class="hljs-number">301</span>æˆ–è€…<span class="hljs-number">302</span>ï¼‰ æ—¶ï¼Œproxy_redirectå¯ä»¥é‡è®¾HTTPå¤´éƒ¨çš„locationæˆ–refreshå­—æ®µã€‚
			#è¯­æ³•ï¼š proxy_redirect[default|off|redirect replacement];
			#å‚æ•°è§£é‡Šï¼šoffï¼šä½¿locationæˆ–è€…refreshå­—æ®µç»´æŒä¸å˜ã€‚
			#é»˜è®¤ï¼š proxy_redirect default;
			#é…ç½®å—ï¼š httpã€ serverã€ location
			proxy_redirect off;
			
			#proxy_next_upstreamï¼šå½“ä¸€å°ä¸Šæ¸¸æœåŠ¡è½¬å‘è¯·æ±‚å‡ºç°é”™è¯¯æ—¶ï¼Œç»§ç»­æ¢ä¸€å°ä¸Šæ¸¸æœåŠ¡å™¨è½¬å‘è¯·æ±‚
			#è¯­æ³•ï¼šproxy_next_upstream[error|timeout|invalid_header|http_500|http_502|http_503|http_504|http_404|off];
			#é»˜è®¤ï¼š proxy_next_upstream error timeout;
			#é…ç½®å—ï¼š httpã€ serverã€ location
			proxy_next_upstream timeout;
		&#125;
    &#125; 
&#125;</code></pre>



<p>server_nameä¸Hostçš„åŒ¹é…ä¼˜å…ˆçº§</p>
<table>
<thead>
<tr>
<th>server_nameä¸Hostçš„åŒ¹é…ä¼˜å…ˆçº§</th>
<th>æ¡ˆä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td>é¦–å…ˆé€‰æ‹©æ‰€æœ‰å­—ç¬¦ä¸²å®Œå…¨åŒ¹é…çš„server_name</td>
<td>å¦‚ï¼š<a href="http://www.testwab.com" target="_blank" rel="noopener">www.testwab.com</a></td>
</tr>
<tr>
<td>å…¶æ¬¡é€‰æ‹©é€šé…ç¬¦åœ¨å‰é¢çš„server_name</td>
<td>å¦‚ï¼š*.testwab.com</td>
</tr>
<tr>
<td>å…¶æ¬¡é€‰æ‹©é€šé…ç¬¦åœ¨åé¢çš„server_name</td>
<td>å¦‚ï¼š<a href="http://www.testwab" target="_blank" rel="noopener">www.testwab</a>.*</td>
</tr>
<tr>
<td>æœ€åé€‰æ‹©ä½¿ç”¨æ­£åœ¨è¡¨è¾¾å¼æ‰åŒ¹é…çš„server_name</td>
<td>æœ€åé€‰æ‹©ä½¿ç”¨æ­£åœ¨è¡¨è¾¾å¼æ‰åŒ¹é…çš„server_name</td>
</tr>
</tbody></table>
<p>locationçš„åŒ¹é…è§„åˆ™  </p>
<table>
<thead>
<tr>
<th align="center">ç¬¦å·</th>
<th align="center">è§£é‡Š</th>
</tr>
</thead>
<tbody><tr>
<td align="center">=</td>
<td align="center">è¡¨ç¤ºæŠŠURIä½œä¸ºå­—ç¬¦ä¸²ï¼Œ ä»¥ä¾¿ä¸å‚æ•°ä¸­çš„uriåšå®Œå…¨åŒ¹é…ã€‚</td>
</tr>
<tr>
<td align="center">~</td>
<td align="center">è¡¨ç¤ºåŒ¹é…URIæ—¶æ˜¯å­—æ¯å¤§å°å†™æ•æ„Ÿçš„</td>
</tr>
<tr>
<td align="center">~*</td>
<td align="center">è¡¨ç¤ºåŒ¹é…URIæ—¶å¿½ç•¥å­—æ¯å¤§å°å†™é—®é¢˜</td>
</tr>
<tr>
<td align="center">^~</td>
<td align="center">è¡¨ç¤ºåŒ¹é…URIæ—¶åªéœ€è¦å…¶å‰åŠéƒ¨åˆ†ä¸uriå‚æ•°åŒ¹é…å³å¯</td>
</tr>
<tr>
<td align="center">@</td>
<td align="center">ä»…ç”¨äºNginxæœåŠ¡å†…éƒ¨è¯·æ±‚ä¹‹é—´çš„é‡å®šå‘ï¼Œ å¸¦æœ‰@çš„locationä¸ç›´æ¥å¤„ç†ç”¨æˆ·è¯·æ±‚</td>
</tr>
</tbody></table>
<p>rootå’ŒaliasåŒºåˆ«</p>
<blockquote>
<p>å¦‚æœæœ‰ä¸€ä¸ªè¯·æ±‚çš„URIæ˜¯/conf/nginx.confï¼Œ è€Œç”¨æˆ·å®é™…æƒ³è®¿é—®çš„æ–‡ä»¶<br>åœ¨usr/local/nginx/conf/nginx.confã€‚ </p>
<p>aliasï¼š</p>
<p>aliasåœ¨å®é™…æ–‡ä»¶è·¯å¾„çš„æ˜ å°„è¿‡ç¨‹ä¸­ï¼Œå·²ç»å°†locationåé…ç½®çš„/confè¿™éƒ¨åˆ†å»æ‰äº†</p>
<pre><code class="hljs crmsh"><span class="hljs-keyword">location</span> <span class="hljs-title">conf</span> &#123;
	alias usr/local/nginx/conf/;
&#125;</code></pre>

<p>root:</p>
<p>è€Œrootæ²¡æœ‰å»æ‰ï¼Œè¿™ä¹Ÿæ˜¯rootå¯ä»¥æ”¾ç½®åˆ°å…¶ä»–httpã€serverç­‰ä¸­ï¼Œè€Œaliasåªèƒ½æ”¾ç½®locationä¸­çš„åŸå› </p>
<pre><code class="hljs crmsh"><span class="hljs-keyword">location</span> <span class="hljs-title">conf</span>&#123;
	root usr/local/nginx/;
&#125;</code></pre>



<p>aliasè¿˜å¯ä»¥æ·»åŠ æ­£åˆ™è¡¨è¾¾å¼ï¼š</p>
<pre><code class="hljs elixir">location ~ ^<span class="hljs-regexp">/test/</span>(\w+)\.(\w+)<span class="hljs-variable">$ </span>&#123;
	<span class="hljs-keyword">alias</span> usrlocal/nginx/<span class="hljs-variable">$2</span>/<span class="hljs-variable">$1</span>.<span class="hljs-variable">$2</span>;
&#125;</code></pre>

<p>è¯·æ±‚è®¿é—®/test/nginx.confæ—¶ï¼Œè¿”å›usr/local/nginx/conf/nginx.conf</p>
</blockquote>

            </article>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/2020-05/">2020-05</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/Liunx/">Liunx</a>
                    
                      <a class="hover-with-bg" href="/tags/Nginx/">Nginx</a>
                    
                      <a class="hover-with-bg" href="/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/">ä¸­é—´ä»¶</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" target="_blank" rel="nofollow noopener noopener">CC BY-SA 4.0 åè®®</a> ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-6">
                    
                    
                      <a href="/2020/05/31/06%20Zuul%E7%BD%91%E5%85%B3%E6%9C%8D%E5%8A%A1%E9%9B%86%E6%88%90%E9%98%BF%E6%B3%A2%E7%BD%97%E5%8F%8ASwagger%E6%96%87%E6%A1%A3%E9%85%8D%E7%BD%AE/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Zuulç½‘å…³æœåŠ¡é›†æˆé˜¿æ³¢ç½—åŠSwaggeræ–‡æ¡£é…ç½®</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </div>
                  <div class="post-next col-6">
                    
                    
                      <a href="/2020/05/31/04%20%E6%90%BA%E7%A8%8B%E9%98%BF%E6%B3%A2%E7%BD%97%E5%88%86%E5%B8%83%E5%BC%8F%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83/">
                        <span class="hidden-mobile">æºç¨‹é˜¿æ³¢ç½—åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒ</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

            
              <!-- Comments -->
              <div class="comments" id="comments">
                
                
  <div id="vcomments"></div>
  <script defer src="https://cdn.staticfile.org/valine/1.4.14/Valine.min.js" ></script>

  <script type="text/javascript">
    var oldLoadVa = window.onload;
    window.onload = function () {
      oldLoadVa && oldLoadVa();

      new Valine({
        el: "#vcomments",
        app_id: "5o5Kl2LBm0PCREnMBGJPM7I8-gzGzoHsz",
        app_key: "34jqtpneAbJft4I56LcsIwlQ",
        placeholder: "",
        path: window.location.pathname,
        avatar: "retro",
        meta: ["nick","mail","link"],
        pageSize: "10",
        lang: "zh-CN",
        highlight: true,
        recordIP: true,
        serverURLs: "https://5o5kl2lb.lc-cn-n1-shared.com",
      });
    };
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://valine.js.org" target="_blank" rel="nofollow noopener noopener">comments
      powered by Valine.</a></noscript>


              </div>
            
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  
    <!-- APlayer éŸ³ä¹æ’­æ”¾å™¨ -->
    <div id="aplayer"></div>
    <script defer src="https://cdn.staticfile.org/aplayer/1.10.1/APlayer.min.js" ></script>
<link  rel="stylesheet" href="https://cdn.staticfile.org/aplayer/1.10.1/APlayer.min.css" />
<script type="text/javascript">
  var oldLoadAp = window.onload;
  window.onload = function () {
    oldLoadAp && oldLoadAp();

    new APlayer({
      container: document.getElementById('aplayer'),
      fixed: true,
      autoplay: 'true' === 'true',
      loop: 'all',
      order: 'list',
      theme: '#FF3366',
      preload: 'none',
      audio: [{"name":"é”™å­£","artist":"ç§‹åŸä¾","url":"/songs/ç§‹åŸä¾ - é”™å­£.flac","cover":"/songs/img/ç§‹åŸä¾ - é”™å­£.jpg"},{"name":"é£é¸Ÿå’Œè‰","artist":"ä»»ç„¶","url":"/songs/ä»»ç„¶-é£é¸Ÿå’Œè‰.flac","cover":"/songs/img/ä»»ç„¶-é£é¸Ÿå’Œè‰.jpg"},{"name":"åˆšåˆšå¥½","artist":"é‚“å›­é•¿","url":"/songs/åˆšåˆšå¥½.mp3","cover":"/songs/img/åˆšåˆšå¥½.jpg"},{"name":"è¿·å¤±å¹»å¢ƒ","artist":"IN-K ç‹å¿»è¾°","url":"/songs/IN-K ç‹å¿»è¾° - è¿·å¤±å¹»å¢ƒ.mp3","cover":"/songs/img/IN-K ç‹å¿»è¾° - è¿·å¤±å¹»å¢ƒ.jpg"},{"name":"ç”¨åŠ›æ´»ç€","artist":"å¼ èŒœ","url":"/songs/å¼ èŒœ - ç”¨åŠ›æ´»ç€.flac","cover":"/songs/img/å¼ èŒœ - ç”¨åŠ›æ´»ç€.jpg"},{"name":"å–„å˜","artist":"ç‹é–é›¯ä¸èƒ–","url":"/songs/ç‹é–é›¯ä¸èƒ– - å–„å˜.flac","cover":"/songs/img/ç‹é–é›¯ä¸èƒ– - å–„å˜.jpg"},{"name":"AEBD","artist":"äº¦æŸ¯","url":"/songs/äº¦æŸ¯ - AEBD.mp3","cover":"/songs/img/AEBD.jpg"},{"name":"ä¸çŸ¥æ‰€æª","artist":"ç‹é–é›¯ä¸èƒ–","url":"/songs/ç‹é–é›¯ä¸èƒ–-ä¸çŸ¥æ‰€æª.flac","cover":"/songs/img/ç‹é–é›¯ä¸èƒ–-ä¸çŸ¥æ‰€æª.jpg"},{"name":"æŒ¥éœ","artist":"é«˜é±¼","url":"/songs/é«˜é±¼-æŒ¥éœ.flac","cover":"/songs/img/é«˜é±¼-æŒ¥éœ.jpg"},{"name":"éš”å²¸è§‚ç«","artist":"é«˜æº","url":"/songs/é«˜æº-éš”å²¸è§‚ç«.flac","cover":"/songs/img/é«˜æº-éš”å²¸è§‚ç«.jpg"},{"name":"Ifï¼ˆç¿»è‡ª ä¸å¯ï¼‰","artist":"ä¸ƒå…ƒ","url":"/songs/ä¸ƒå…ƒ - Ifï¼ˆç¿»è‡ª ä¸å¯ï¼‰.flac","cover":"/songs/img/ä¸ƒå…ƒ - Ifï¼ˆç¿»è‡ª ä¸å¯ï¼‰.jpg"},{"name":"å›åˆ°å¤å¤©","artist":"åšä¸ƒçˆ·/çˆ±å†™æ­Œçš„å°ç”°","url":"/songs/å›åˆ°å¤å¤©.mp3","cover":"/songs/img/å›åˆ°å¤å¤©.png"},{"name":"MOM","artist":"ä½ çš„äºŒæ™ºbb","url":"/songs/MOM.mp3","cover":"/songs/img/MOM.jpg"},{"name":"å†™ç»™é»„æ·®","artist":"è§£å¿§é‚µå¸…","url":"/songs/å†™ç»™é»„æ·®.mp3","cover":"/songs/img/å†™ç»™é»„æ·®.jpg"},{"name":"ReadÂ AllÂ AboutÂ It","artist":"THEO","url":"/songs/ReadÂ AllÂ AboutÂ It.mp3","cover":"/songs/img/Read All About It.jpg"},{"name":"Can We Kiss Forever.mp3","artist":"Kina,Adriana Proenza","url":"/songs/Kina,Adriana Proenza - Can We Kiss Forever.mp3","cover":"/songs/img/Can We Kiss Forever.jpg"},{"name":"MELANCHOLY","artist":"White Cherry","url":"/songs/White Cherry - MELANCHOLY.mp3","cover":"/songs/img/MELANCHOLY.jpg"},{"name":"roundÂ andÂ round","artist":"æ™´æ¡‘å‘€","url":"/songs/æ™´æ¡‘å‘€ - roundÂ andÂ round(åŸç‰ˆéŸ³ä¹).mp3","cover":"/songs/img/Round and round.jpg"},{"name":"Girls Like Youï¼ˆtoby randallï¼‰ï¼ˆç¿»è‡ª J.Flaï¼‰","artist":"AGAM","url":"/songs/AGAM - Girls Like Youï¼ˆtoby randallï¼‰ï¼ˆç¿»è‡ª J.Flaï¼‰.flac","cover":"/songs/img/AGAM - Girls Like Youï¼ˆtoby randallï¼‰.jpg"},{"name":"è¿‡æ´»","artist":"é«˜é±¼","url":"/songs/é«˜é±¼ - è¿‡æ´».mp3","cover":"/songs/img/é«˜é±¼-è¿‡æ´».jfif"},{"name":"æ™šå©š","artist":"éš”å£è€æ¨Š","url":"/songs/æ™šå©š - éš”å£è€æ¨Š.m4a","cover":"/songs/img/å¤šæƒ³åœ¨å¹³åº¸çš„ç”Ÿæ´»æ‹¥æŠ±ä½ .jpg"},{"name":"ç†æƒ³ä¸‰æ—¬","artist":"é™ˆé¸¿å®‡","url":"/songs/ç†æƒ³ä¸‰æ—¬.mp3","cover":"/songs/img/ç†æƒ³ä¸‰æ—¬.jpg"},{"name":"å¤šæƒ³åœ¨å¹³åº¸çš„ç”Ÿæ´»æ‹¥æŠ±ä½ ","artist":"éš”å£è€æ¨Š","url":"/songs/å¤šæƒ³åœ¨å¹³åº¸çš„ç”Ÿæ´»æ‹¥æŠ±ä½ .mp3","cover":"/songs/img/å¤šæƒ³åœ¨å¹³åº¸çš„ç”Ÿæ´»æ‹¥æŠ±ä½ .jpg"},{"name":"æˆ‘æ›¾","artist":"éš”å£è€æ¨Š","url":"/songs/æˆ‘æ›¾.mp3","cover":"/songs/img/å¤šæƒ³åœ¨å¹³åº¸çš„ç”Ÿæ´»æ‹¥æŠ±ä½ .jpg"},{"name":"å¾—ä¸åˆ°ä½ ","artist":"éš”å£è€æ¨Š","url":"/songs/å¾—ä¸åˆ°ä½ .mp3","cover":"/songs/img/å¾—ä¸åˆ°ä½ .jpg"},{"name":"è¿™ä¸€ç”Ÿå…³äºä½ çš„é£æ™¯","artist":"éš”å£è€æ¨Š","url":"/songs/è¿™ä¸€ç”Ÿå…³äºä½ çš„é£æ™¯.mp3","cover":"/songs/img/è¿™ä¸€ç”Ÿå…³äºä½ çš„é£æ™¯.jfif"},{"name":"é‚£ä¸ªå¥³å­©å¯¹æˆ‘è¯´","artist":"æˆ´ç¾½å½¤","url":"/songs/é‚£ä¸ªå¥³å­©å¯¹æˆ‘è¯´.mp3","cover":"/songs/img/é‚£ä¸ªå¥³å­©å¯¹æˆ‘è¯´.png"}]
    });
  }
</script>

  

  

  <footer class="mt-5">
    <div class="text-center py-3">
        <div>
            <i class="iconfont icon-love"></i>
            <span>å°†å–œæ¬¢çš„ä¸€åˆ‡ç•™åœ¨èº«è¾¹ è¿™ä¾¿æ˜¯åŠªåŠ›çš„æ„ä¹‰</span></a>
            <i class="iconfont icon-love"></i>
        </div>
        
  <div class="statistics">
    
    

    
      
        <!-- LeanCloud ç»Ÿè®¡PV -->
        <span id="leancloud-site-pv-container" style="display: none">
            æ€»è®¿é—®é‡ 
            <span id="leancloud-site-pv"></span>
             æ¬¡
          </span>
      
      
        <!-- LeanCloud ç»Ÿè®¡UV -->
        <span id="leancloud-site-uv-container" style="display: none">
            æ€»è®¿å®¢æ•° 
            <span id="leancloud-site-uv"></span>
             äºº
          </span>
      

    
  </div>


        
  <!-- å¤‡æ¡ˆä¿¡æ¯ -->
  <div class="beian">
    <a href="http://beian.miit.gov.cn/" target="_blank"
       rel="nofollow noopener">é™•ICPå¤‡20008687å·-1</a>
    
      <a
        href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=61011302000993"
        rel="nofollow noopener"
        class="beian-police"
        target="_blank"
      >
        <span class="beian-police-sep">&nbsp;|&nbsp;</span>
        
          <img src="/img/police_beian.png" srcset="/img/loading.gif" alt="police-icon" />
        
        <span>é™•å…¬ç½‘å®‰å¤‡ 61011302000993å·</span>
      </a>
     
  </div>


        
    </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/main.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>



  <script defer>
  (function () {
    // æŸ¥è¯¢å­˜å‚¨çš„è®°å½•
    function getRecord(Counter, target) {
      return new Promise(function (resolve, reject) {
        Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({target})))
          .then(resp => resp.json())
          .then(({results, code, error}) => {
            if (code === 401) {
              throw error;
            }
            if (results && results.length > 0) {
              var record = results[0];
              resolve(record);
            } else {
              Counter('post', '/classes/Counter', {target, time: 0})
                .then(resp => resp.json())
                .then((record, error) => {
                  if (error) {
                    throw error;
                  }
                  resolve(record);
                }).catch(error => {
                console.error('Failed to create', error);
                reject(error);
              });
            }
          }).catch((error) => {
          console.error('LeanCloud Counter Error:', error);
          reject(error);
        });
      })
    }

    // å‘èµ·è‡ªå¢è¯·æ±‚
    function increment(Counter, incrArr) {
      return new Promise(function (resolve, reject) {
        Counter('post', '/batch', {
          "requests": incrArr
        }).then((res) => {
          res = res.json();
          if (res.error) {
            throw res.error;
          }
          resolve(res);
        }).catch((error) => {
          console.error('Failed to save visitor count', error);
          reject(error);
        });
      });
    }

    // æ„å»ºè‡ªå¢è¯·æ±‚ä½“
    function buildIncrement(objectId) {
      return {
        "method": "PUT",
        "path": `/1.1/classes/Counter/${ objectId }`,
        "body": {
          "time": {
            '__op': 'Increment',
            'amount': 1
          }
        }
      }
    }

    // æ ¡éªŒæ˜¯å¦ä¸ºæœ‰æ•ˆçš„ UV
    function validUV() {
      var key = 'LeanCloud_UV_Flag';
      var flag = localStorage.getItem(key);
      if (flag) {
        // è·ç¦»æ ‡è®°å°äº 24 å°æ—¶åˆ™ä¸è®¡ä¸º UV
        if (new Date().getTime() - parseInt(flag) <= 86400000) {
          return false;
        }
      }
      localStorage.setItem(key, new Date().getTime().toString());
      return true;
    }

    function addCount(Counter) {
      var enableIncr = 'true' === 'true' && window.location.hostname !== 'localhost';
      var getterArr = [];
      var incrArr = [];

      // è¯·æ±‚ PV å¹¶è‡ªå¢
      var pvCtn = document.querySelector('#leancloud-site-pv-container');
      if (pvCtn || enableIncr) {
        var pvGetter = getRecord(Counter, 'site-pv').then((record) => {
          incrArr.push(buildIncrement(record.objectId))
          var ele = document.querySelector('#leancloud-site-pv');
          if (ele) {
            ele.innerText = record.time + 1;
            if (pvCtn) {
              pvCtn.style.display = 'inline';
            }
          }
        });
        getterArr.push(pvGetter);
      }

      // è¯·æ±‚ UV å¹¶è‡ªå¢
      var uvCtn = document.querySelector('#leancloud-site-uv-container');
      if (uvCtn || enableIncr) {
        var uvGetter = getRecord(Counter, 'site-uv').then((record) => {
          var vuv = validUV();
          vuv && incrArr.push(buildIncrement(record.objectId))
          var ele = document.querySelector('#leancloud-site-uv');
          if (ele) {
            ele.innerText = record.time + (vuv ? 1 : 0);
            if (uvCtn) {
              uvCtn.style.display = 'inline';
            }
          }
        });
        getterArr.push(uvGetter);
      }

      // å¦‚æœæ˜¯æ–‡ç« ï¼Œè¯·æ±‚æ–‡ç« çš„æµè§ˆæ•°ï¼Œå¹¶è‡ªå¢
      if ('true' === 'true') {
        var viewCtn = document.querySelector('#leancloud-post-views-container');
        if (viewCtn || enableIncr) {
          var target = decodeURI('/2020/05/31/05%20Nginx%E7%9B%B8%E5%85%B3%E8%B5%84%E6%96%99/');
          var viewGetter = getRecord(Counter, target).then((record) => {
            incrArr.push(buildIncrement(record.objectId))
            if (viewCtn) {
              var ele = document.querySelector('#leancloud-post-views');
              if (ele) {
                ele.innerText = (record.time || 0) + 1;
                viewCtn.style.display = 'inline';
              }
            }
          });
          getterArr.push(viewGetter);
        }
      }

      // å¦‚æœå¯åŠ¨è®¡æ•°è‡ªå¢ï¼Œæ‰¹é‡å‘èµ·è‡ªå¢è¯·æ±‚
      if (enableIncr) {
        Promise.all(getterArr).then(() => {
          incrArr.length > 0 && increment(Counter, incrArr);
        })
      }
    }

    var app_id = '5o5Kl2LBm0PCREnMBGJPM7I8-gzGzoHsz'
    var app_key = '34jqtpneAbJft4I56LcsIwlQ'
    var server_url = 'https://5o5kl2lb.lc-cn-n1-shared.com'

    function fetchData(api_server) {
      var Counter = (method, url, data) => {
        return fetch(`${ api_server }/1.1${ url }`, {
          method,
          headers: {
            'X-LC-Id': app_id,
            'X-LC-Key': app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };

      addCount(Counter);
    }

    var api_server = app_id.slice(-9) !== '-MdYXbMMI' ? server_url : `https://${ app_id.slice(0, 8).toLowerCase() }.api.lncldglobal.com`;

    if (api_server) {
      fetchData(api_server);
    } else {
      fetch('https://app-router.leancloud.cn/2/route?appId=' + app_id)
        .then(resp => resp.json())
        .then(({api_server}) => {
          fetchData('https://' + api_server);
        });
    }
  })();
</script>






  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: 'article.markdown-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "Nginxç›¸å…³èµ„æ–™&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>







  
  
    <script>
      !function (e, t, a) {
        function r() {
          for (var e = 0; e < s.length; e++) s[e].alpha <= 0 ? (t.body.removeChild(s[e].el), s.splice(e, 1)) : (s[e].y--, s[e].scale += .004, s[e].alpha -= .013, s[e].el.style.cssText = "left:" + s[e].x + "px;top:" + s[e].y + "px;opacity:" + s[e].alpha + ";transform:scale(" + s[e].scale + "," + s[e].scale + ") rotate(45deg);background:" + s[e].color + ";z-index:99999");
          requestAnimationFrame(r)
        }

        function n() {
          var t = "function" == typeof e.onclick && e.onclick;
          e.onclick = function (e) {
            t && t(), o(e)
          }
        }

        function o(e) {
          var a = t.createElement("div");
          a.className = "heart", s.push({
            el: a,
            x: e.clientX - 5,
            y: e.clientY - 5,
            scale: 1,
            alpha: 1,
            color: c()
          }), t.body.appendChild(a)
        }

        function i(e) {
          var a = t.createElement("style");
          a.type = "text/css";
          try {
            a.appendChild(t.createTextNode(e))
          } catch (t) {
            a.styleSheet.cssText = e
          }
          t.getElementsByTagName("head")[0].appendChild(a)
        }

        function c() {
          return "rgb(" + ~~(255 * Math.random()) + "," + ~~(255 * Math.random()) + "," + ~~(255 * Math.random()) + ")"
        }

        var s = [];
        e.requestAnimationFrame = e.requestAnimationFrame || e.webkitRequestAnimationFrame || e.mozRequestAnimationFrame || e.oRequestAnimationFrame || e.msRequestAnimationFrame || function (e) {
          setTimeout(e, 1e3 / 60)
        }, i(".heart{width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: fixed;}.heart:after{top: -5px;}.heart:before{left: -5px;}"), n(), r()
      }(window, document);
    </script>
  











  

  

  

  

  

  





</body>
</html>
